{% extends "base.html" %}

{% block title %}
    <title>Fixture Cleaning Records</title>
{% endblock title %}

{% block content %}
<style>
    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }
    h1 {
        color: #333;
        text-align: center;
        margin-bottom: 30px;
    }
    .add-new-btn {
        display: inline-block;
        background-color: #4CAF50;
        color: white;
        padding: 10px 20px;
        text-decoration: none;
        border-radius: 5px;
        margin-bottom: 20px;
        transition: background-color 0.3s;
    }
    .add-new-btn:hover {
        background-color: #45a049;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
    }
    th, td {
        padding: 15px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    th {
        background-color: #f2f2f2;
        font-weight: bold;
        color: #333;
    }
    tr:hover {
        background-color: #f5f5f5;
    }
    .action-btn {
        display: inline-block;
        padding: 5px 10px;
        margin: 2px;
        text-decoration: none;
        color: white;
        border-radius: 3px;
        transition: background-color 0.3s;
    }
    .view-btn { background-color: #3498db; }
    .view-btn:hover { background-color: #2980b9; }
    .edit-btn { background-color: #f39c12; }
    .edit-btn:hover { background-color: #e67e22; }
    .delete-btn { background-color: #e74c3c; }
    .delete-btn:hover { background-color: #c0392b; }
    .no-records {
        text-align: center;
        padding: 20px;
        color: #777;
        font-style: italic;
    }
    .filter-form {
        background-color: #f8f8f8;
        padding: 20px;
        border-radius: 5px;
        margin-bottom: 20px;
    }
    .filter-form input, .filter-form select {
        margin-right: 10px;
        padding: 5px;
    }
    .filter-form button {
        padding: 5px 10px;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 3px;
        cursor: pointer;
    }
    .filter-form button:hover {
        background-color: #45a049;
    }
    .search-bar {
        margin-bottom: 20px;
    }
    .search-bar input[type="text"] {
        width: 70%;
        padding: 10px;
        font-size: 16px;
    }
    .search-bar button {
        padding: 10px 20px;
        font-size: 16px;
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
    }
    .search-bar button:hover {
        background-color: #45a049;
    }
    .search-and-filter {
        background-color: #f8f8f8;
        padding: 20px;
        border-radius: 5px;
        margin-bottom: 20px;
    }
    .search-bar, .filter-form {
        margin-bottom: 15px;
    }
    .search-form, .filter-form {
        display: flex;
        gap: 10px;
        align-items: center;
    }
    input[type="text"], input[type="date"] {
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
    }
    .search-hint {
        font-size: 0.9em;
        color: #666;
        margin-top: 5px;
    }
    .clear-filters {
        color: #666;
        text-decoration: none;
    }
    .clear-filters:hover {
        text-decoration: underline;
    }
    .date-range {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .export-buttons {
        margin-bottom: 20px;
    }
    .export-btn {
        display: inline-block;
        padding: 10px 20px;
        margin-right: 10px;
        text-decoration: none;
        color: white;
        border-radius: 5px;
        transition: background-color 0.3s;
    }
    .export-excel { background-color: #217346; }
    .export-excel:hover { background-color: #1e6f41; }
    .export-pdf { background-color: #db4437; }
    .export-pdf:hover { background-color: #c53929; }

</style>

<div class="container">
    <h1>Fixture Cleaning Records</h1>
    <div class="search-and-filter">
        <div class="search-bar">
            <h3>Search Fixture Cleaning Records</h3>
            <form method="get" class="search-form">
                <input type="text" name="search" placeholder="Search by control no, location, operator..." value="{{ search_query }}">
                <button type="submit">Search</button>
            </form>
            <p class="search-hint">Tip: You can search across multiple fields including control number, location, shift, and operator name.</p>
        </div>
    
        <div class="filter-form">
            <h3>Filter Records</h3>
            <form method="get" class="filter-form">
                <input type="hidden" name="search" value="{{ search_query }}">
                <div class="date-range">
                    <label for="date_from">From:</label>
                    <input type="date" id="date_from" name="date_from" value="{{ date_from }}">
                    <label for="date_to">To:</label>
                    <input type="date" id="date_to" name="date_to" value="{{ date_to }}">
                </div>
                <button type="submit">Apply Filters</button>
                <a href="{% url 'list_fixture_cleaning_records' %}" class="clear-filters">Clear All Filters</a>
            </form>
        </div>
        <div class="export-buttons">
            <a href="{% url 'list_fixture_cleaning_records' %}?{% if request.GET.urlencode %}{{ request.GET.urlencode }}&{% endif %}export=excel" class="export-btn export-excel">Export to Excel</a>
            <a href="{% url 'list_fixture_cleaning_records' %}?{% if request.GET.urlencode %}{{ request.GET.urlencode }}&{% endif %}export=pdf" class="export-btn export-pdf">Export to PDF</a>
        </div>
    
    </div>
    
    <a href="{% url 'add_fixture_cleaning_record' %}" class="add-new-btn">Add New Record</a>

    {% if records %}
        <table>
            <thead>
                <tr>
                    <th>Control No</th>
                    <th>Location</th>
                    <th>Shift</th>
                    <th>Date</th>
                    <th>Operator Name</th>
                    <th>Tag Available</th>
                    <th>Tag Condition</th>
                    <th>No Dust</th>
                    <th>No Epoxy Coating</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for record in records %}
                <tr>
                    <td>{{ record.fixture_control_no }}</td>
                    <td>{{ record.fixture_location }}</td>
                    <td>{{ record.shift }}</td>
                    <td>{{ record.date }}</td>
                    <td>{{ record.operator_name.username }}</td>
                    <td>{{ record.verification_tag_available }}</td>
                    <td>{{ record.verification_tag_condition }}</td>
                    <td>{{ record.no_dust_on_fixture }}</td>
                    <td>{{ record.no_epoxy_coating_on_fixture }}</td>
                    <td>
                        <a href="{% url 'fixture_cleaning_record_detail' record.pk %}" class="action-btn view-btn">View</a>
                        <a href="{% url 'update_fixture_cleaning_record' record.pk %}" class="action-btn edit-btn">Edit</a>
                        <a href="{% url 'delete_fixture_cleaning_record' record.pk %}" class="action-btn delete-btn">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="no-records">No records found.</p>
    {% endif %}
</div>
{% endblock content %}

